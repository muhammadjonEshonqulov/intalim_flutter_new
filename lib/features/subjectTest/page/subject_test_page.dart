import 'dart:convert';import 'package:easy_localization/easy_localization.dart';import 'package:flutter/material.dart';import 'package:flutter_bloc/flutter_bloc.dart';import 'package:intalim/app/router.dart';import '../../../common/services/utils/utils.dart';import '../../../common/widgets/appbar.dart';import '../block/subject_tests_bloc.dart';import '../model/subject_test_data.dart';import '../model/subject_tests_event.dart';import '../repository/subject_tests_repository.dart';class SubjectTestsPageWithRepo extends StatelessWidget {  const SubjectTestsPageWithRepo({super.key});  @override  Widget build(BuildContext context) {    return BlocProvider(      create: (context) => SubjectTestsBloc(context.read<SubjectTestsRepository>()),      child: const SubjectTestsScreen(),    );  }}class SubjectTestsScreen extends StatefulWidget {  const SubjectTestsScreen({super.key});  @override  State<SubjectTestsScreen> createState() => _SubjectTestsScreen();}class _SubjectTestsScreen extends State<SubjectTestsScreen> {  late SubjectTestsBloc _subjectTestsBloc;  @override  void initState() {    _subjectTestsBloc = BlocProvider.of<SubjectTestsBloc>(context);    _subjectTestsBloc.add(SubjectTestsEventData());    super.initState();  }  @override  Widget build(BuildContext context) {    return SafeArea(        child: Scaffold(            appBar: PreferredSize(              preferredSize: Size.fromHeight(1000.0),              child: CustomAppBar(titleName: "lesson_test".tr()),            ),            backgroundColor: Utils.backColor,            body: StreamBuilder<List<SubjectTestData>>(              stream: _subjectTestsBloc.subjectTestFromLocal,              builder: (context, snapshot) {                if (snapshot.hasData) {                  final tasks = snapshot.data;                  return ListView.builder(                    itemCount: tasks?.length,                    itemBuilder: (context, index) {                      return SubjectTestItem(subjectTestData: tasks?[index]);                    },                  );                } else {                  return Center(child: Text("loading".tr()));                }              },            )));  }}class SubjectTestItem extends StatelessWidget {  final SubjectTestData? subjectTestData;  const SubjectTestItem({required this.subjectTestData});  // final Map<String, dynamic> data2;  @override  Widget build(BuildContext context) {    // Map<String, dynamic> subjectTestName = json.decode(subjectTestData?.subjectTest??"");    // Result subjectTestName = Result.fromJson(json.decode(subjectTestData?.result ?? ""));    // kprint("subjectTestName->" + subjectTestName.uz.toString());    return Card(      margin: EdgeInsets.all(8.0),      color: Colors.white,      shape: RoundedRectangleBorder(        borderRadius: BorderRadius.all(Radius.circular(8.0)),      ),      elevation: 0.0,      child: InkWell(        onTap: () {          router.push(            Routes.topic,            //     extra: {            //   "eduTypeSubjectTestId": subjectTestData?.id,            //   "eduTypeSubjectTestName": subjectTestName.uz?.toString() ?? "",            // }          );        },        child: Padding(          padding: EdgeInsets.all(8.0),          child: Row(            children: [              Image.asset(                'assets/images/subjectTest_icon.png',                width: 40.0,                height: 40.0,                fit: BoxFit.cover,              ),              Expanded(                child: Padding(                  padding: EdgeInsets.all(8.0),                  child: Text(                    subjectTestData?.nameUz.toString() ?? "",                    style: TextStyle(                      fontFamily: 'Montserrat',                      fontWeight: FontWeight.w600,                      color: Colors.black,                      fontSize: 14.0,                    ),                  ),                ),              ),              Image.asset(                'assets/images/more.png',                width: 30.0,                height: 30.0,                fit: BoxFit.cover,              ),            ],          ),        ),      ),    );  }}